{% extends "lotto/base.html" %}

{% block title %}판매 실적 - 로또 사이트{% endblock %}

{% block content %}
<h2>판매 실적</h2>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0;">
    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 10px; text-align: center;">
        <h3 style="margin-bottom: 10px;">총 판매량</h3>
        <p style="font-size: 2.5em; font-weight: bold;">{{ total_tickets }}</p>
        <p>장</p>
    </div>
    
    <div style="background: #28a745; color: white; padding: 25px; border-radius: 10px; text-align: center;">
        <h3 style="margin-bottom: 10px;">자동 구매</h3>
        <p style="font-size: 2.5em; font-weight: bold;">{{ auto_tickets }}</p>
        <p>장</p>
    </div>
    
    <div style="background: #17a2b8; color: white; padding: 25px; border-radius: 10px; text-align: center;">
        <h3 style="margin-bottom: 10px;">수동 구매</h3>
        <p style="font-size: 2.5em; font-weight: bold;">{{ manual_tickets }}</p>
        <p>장</p>
    </div>
</div>

<h3 style="margin-top: 40px;">사용자별 판매 통계 (상위 10명)</h3>
{% if user_stats %}
    <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
        <thead>
            <tr style="background: #667eea; color: white;">
                <th style="padding: 12px; text-align: left;">사용자</th>
                <th style="padding: 12px; text-align: left;">구매 수</th>
            </tr>
        </thead>
        <tbody>
            {% for stat in user_stats %}
            <tr style="border-bottom: 1px solid #ddd;">
                <td style="padding: 12px;">{{ stat.user__username }}</td>
                <td style="padding: 12px;">{{ stat.ticket_count }}장</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>데이터가 없습니다.</p>
{% endif %}

<h3 style="margin-top: 40px;">날짜별 판매 통계 (최근 30일)</h3>
{% if daily_stats %}
    <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
        <thead>
            <tr style="background: #667eea; color: white;">
                <th style="padding: 12px; text-align: left;">날짜</th>
                <th style="padding: 12px; text-align: left;">판매량</th>
            </tr>
        </thead>
        <tbody>
            {% for stat in daily_stats %}
            <tr style="border-bottom: 1px solid #ddd;">
                <td style="padding: 12px;">{{ stat.date|date:"Y-m-d" }}</td>
                <td style="padding: 12px;">{{ stat.count }}장</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>데이터가 없습니다.</p>
{% endif %}
{% endblock %}

